# 要件定義書：文字数カウント × AI文章作成支援ツール

## 1. プロダクト概要

### 1.1 コンセプト
AI時代の「文章のものさし」：論理を組み立て、伝える力を養う構成支援・文字数カウントツール。

大学生がレポート作成時に日常的に利用する「文字数カウント」の動線に、論理構成の「型」を設計する機能を組み込むことで、人間自身の文章記入能力をアップデートする。

### 1.2 解決したい課題
- AIによる執筆代行が普及する中で、人間が論理を組み立てる機会が失われている
- 文章の「送り手」と「受け手」の間に認識のズレが生じている
- AIに丸投げするのではなく、人間が主導権（構成案）を持ってAIと協働するための「論理の基準」が必要

### 1.3 ターゲットユーザー
- レポート作成に不慣れな大学1〜2年生
- AI利用による自身の思考力低下に不安を感じているAIネイティブ世代

---

## 2. 技術スタック

| カテゴリ | 技術 |
|---------|------|
| フレームワーク | Next.js (App Router) |
| 言語 | TypeScript |
| 認証 | BetterAuth (Google認証) |
| データベース | Turso (SQLite) |
| AI API | Gemini API |
| ホスティング | Google Cloud (Cloud Run) |
| スタイリング | Tailwind CSS (予定) |
| バージョン管理 | GitHub |

---

## 3. 機能要件

### 3.1 認証・ユーザー管理

#### ゲストモード
- **未ログインでも利用可能な機能**
  - 文字数カウント（基本機能）
  - 構成ブロックの配置・編集
  - 文字数配分ゲージの利用
- **ログイン必須の機能**
  - テンプレート・フォルダの保存
  - AI機能の利用
  - 過去の経験データの蓄積

#### 認証方法
- Google認証のみ（BetterAuth使用）

#### ユーザープロフィール
| 項目 | 説明 |
|------|------|
| 名前 | 表示名 |
| 大学名 | 所属大学 |
| 専攻 | 学部・学科 |
| 過去の経験 | 経験データ（AIの提案に活用）※下記参照 |

#### 経験データの蓄積方法

| 方法 | 説明 |
|------|------|
| 自動蓄積 | 文章を書くたびに、AIが内容から経験を抽出・保存 |
| 手動登録 | ユーザーが自分の経験を直接入力・管理 |

※両方の方法で蓄積された経験データは、AIによる「経験の提案」機能で活用される

---

### 3.2 コア機能

#### 3.2.1 正確なリアルタイムカウント
- テキストエリア全体の文字数を瞬時にカウント
- 単語数のカウント
- 各構成ブロックごとの文字数表示

#### 3.2.2 カスタム・コンポーネント・エディタ

##### デフォルト構成（PREP法）
新規ドキュメント作成時、以下のブロックがデフォルトで配置される：

| 順番 | ブロック | 説明 |
|------|----------|------|
| 1 | 結論（Point） | 最初に主張・結論を述べる |
| 2 | 理由（Reason） | 結論を支える理由を説明 |
| 3 | 具体例（Example） | 理由を裏付ける具体例を提示 |
| 4 | 結論（Point） | 最後に結論を再度強調 |

##### 追加可能なブロック
必要に応じてドラッグ＆ドロップで追加できるブロック：

| ブロック | 説明 |
|----------|------|
| 背景 | テーマの前提・状況説明 |
| 課題 | 解決すべき問題点 |
| 解決策 | 課題に対するアプローチ |
| カスタム | ユーザー定義のブロック |

##### 操作
- ドラッグ＆ドロップで追加・削除・並べ替え
- リッチテキスト編集は不要（プレーンテキストのみ）

#### 3.2.3 逆算型・文字数配分ゲージ
- 全体の目標文字数を入力
- 論理バランスに基づいた各パーツの最適文字数を自動計算
- 進捗をリアルタイムで可視化（ゲージ表示）

#### 3.2.4 構成テンプレート＆フォルダ保存

##### プリセットテンプレート
システムで最初から用意されているテンプレート：

| テンプレート名 | 構成 | 用途 |
|---------------|------|------|
| PREP法 | 結論→理由→具体例→結論 | 説得力のある文章、レポート全般 |

※今後、追加テンプレート（起承転結、問題解決型など）を検討

##### ユーザーテンプレート
- 作成した独自の「型」と文章をセットで保存
- 授業科目やレポートの種類ごとにフォルダで整理・再利用
- 保存上限：制限なし

---

### 3.3 AI機能

#### 使用API
- Gemini API

#### AI機能の利用場面

| 機能 | 説明 |
|------|------|
| 文章仕上げ | 各セクションの内容をまとめて綺麗な文章に仕上げる |
| 経験の提案 | ユーザーの過去の経験データを基に、関連する経験を提案 |
| 構成の提案 | テーマに応じた論理構成のパターンを提案 |

#### 執筆モード
| モード | 説明 |
|--------|------|
| カジュアルモード | 親しみやすい、やわらかい文体で執筆 |
| フォーマルモード | 学術的・堅めの文体で執筆 |

#### 利用制限
- 現時点では制限なし

---

### 3.4 エクスポート機能

| 形式 | 優先度 |
|------|--------|
| テキストコピー | メイン（クリップボードにコピー） |
| Word (.docx) | サブ |
| PDF | サブ |

---

## 4. 非機能要件

### 4.1 対応デバイス
- **レスポンシブ対応必須**
  - デスクトップ（メイン想定）
  - タブレット
  - スマートフォン

### 4.2 保存機能
- 自動保存：なし（手動保存）
- オフライン対応：なし

### 4.3 将来的に検討（現時点では対象外）
- 料金プラン（無料/有料）
- 共有機能（他ユーザーとの共同編集）
- 利用制限の導入

---

## 5. UI/UXデザイン

### 5.1 デザインコンセプト
- 「ものさし」のメタファー：自分の思考の偏りや不足を客観的に「測定」できるUI
- 学習体験への誘導：文字数を数えに来たユーザーに対し、邪魔にならない形で「構成を意識させる」シンプルなエディタ

### 5.2 参考デザイン
- [Notion](https://notion.so) - ブロックベースのエディタUI
- [Nani!?](https://nani.now/ja) - クリーンでモダンなAIツールのUI

### 5.3 デザイン方針
- ミニマルでクリーンなインターフェース
- 直感的なドラッグ＆ドロップ操作
- 進捗が一目でわかるビジュアルゲージ
- ダークモード対応（検討）

---

## 6. 画面構成（想定）

### 6.1 主要画面

| 画面 | 説明 |
|------|------|
| ランディングページ | サービス紹介、ゲストモードへの導線 |
| エディタ画面 | メイン機能（文字数カウント、構成ブロック編集） |
| テンプレート一覧 | 保存したテンプレートの管理 |
| フォルダ管理 | 科目・種類ごとの整理 |
| プロフィール設定 | ユーザー情報の編集 |
| 経験データ管理 | 過去の経験の確認・編集 |

---

## 7. データモデル（概要）

### 7.1 ユーザー (User)
```
- id: string (primary key)
- name: string
- email: string
- university: string (nullable)
- major: string (nullable)
- createdAt: timestamp
- updatedAt: timestamp
```

### 7.2 経験 (Experience)
```
- id: string (primary key)
- userId: string (foreign key)
- title: string
- content: text
- category: string
- source: enum ('auto', 'manual')  // 自動蓄積 or 手動登録
- documentId: string (nullable)    // 自動蓄積の場合、元のドキュメントID
- createdAt: timestamp
- updatedAt: timestamp
```

### 7.3 ドキュメント (Document)
```
- id: string (primary key)
- userId: string (foreign key, nullable for guest)
- title: string
- targetCharCount: number
- folderId: string (foreign key, nullable)
- createdAt: timestamp
- updatedAt: timestamp
```

### 7.4 構成ブロック (Block)
```
- id: string (primary key)
- documentId: string (foreign key)
- type: enum ('point', 'reason', 'example', 'background', 'problem', 'solution', 'custom')
  // point: 結論, reason: 理由, example: 具体例, background: 背景, problem: 課題, solution: 解決策
- label: string
- content: text
- order: number
- targetCharCount: number
```

### 7.5 フォルダ (Folder)
```
- id: string (primary key)
- userId: string (foreign key)
- name: string
- parentId: string (nullable, for nesting)
- createdAt: timestamp
```

### 7.6 テンプレート (Template)
```
- id: string (primary key)
- userId: string (foreign key)
- name: string
- blocks: json (ブロック構成のスナップショット)
- createdAt: timestamp
```

---

## 8. 開発フェーズ（案）

### Phase 1: MVP（最小限の機能）
- [ ] プロジェクトセットアップ（Next.js App Router）
- [ ] 基本的な文字数カウント機能
- [ ] 構成ブロックエディタ（ドラッグ＆ドロップ）
- [ ] 文字数配分ゲージ
- [ ] ゲストモードでの利用

### Phase 2: 認証・保存機能
- [ ] BetterAuth導入（Google認証）
- [ ] Tursoデータベース連携
- [ ] ドキュメント保存機能
- [ ] テンプレート・フォルダ機能

### Phase 3: AI機能
- [ ] Gemini API連携
- [ ] 文章仕上げ機能
- [ ] 構成提案機能
- [ ] 執筆モード（カジュアル/フォーマル）

### Phase 4: ユーザー体験向上
- [ ] 経験データ蓄積・提案機能
- [ ] エクスポート機能（Word, PDF）
- [ ] UIブラッシュアップ
- [ ] レスポンシブ最適化

---

## 9. 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-12-25 | 初版作成 |
| 2025-12-25 | PREP法デフォルト構成、追加ブロック、経験データ蓄積方法を追記 |

